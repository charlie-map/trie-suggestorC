<html>
	<head>
		<link rel="shortcut icon" type="image/png" href="https://i.pinimg.com/originals/19/95/0c/19950c83ac1f0a4ca85819338e5f2a03.png">

		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap" rel="stylesheet">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	</head>
	<body>
		<style>
			:root {
				--duration: 3.2s;
				--stagger: .65s;
				--easing: cubic-bezier(.36,.07,.25,1);
				--offscreen: 130vmax;
				/*cubic-bezier(.5, 0, .4, 1);*/
				--color-bg: #0d7377;
				--color-blue: #d44f0e;
				--color-shadow: #211842;
				--color-bright-blue: #14ffec;
				--color-medium-blue: #11bdaf;
			}

			* {
				font-family: 'Montserrat', sans-serif;
				margin: 0;
				padding: 0;

				transform-style: preserve-3d;
			}

			body {
				height: 100%;
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				background: var(--color-bg);
			}

			#typetracker {
				margin-top: 80px;

				background: #fff;
				width: 80%;
				height: 100px;
				border: none;
				border-radius: 10px;

				display: flex;
				align-items: center;
				justify-content: center;

				box-shadow: rgba(0, 0, 0, 0.3) 0px 19px 38px, rgba(0, 0, 0, 0.22) 0px 15px 12px;
			}

			#timebar {
				content: '';
				display: block;
				position: absolute;
				top: 0;
				left: 0;

				border-top-left-radius: 25px;
				border-top-right-radius: 25px;

				height: 7px;
				background: var(--color-blue);
			}

			#timer {
				content: '';
				display: block;
				position: absolute;
				top: 7px;
				left: 4px;

				width: 115px;
				height: 40px;

				font-size: 20px;
			}

			#inputbox {
				width: 0;
				border: none;
				outline: none;
			}

			#blinker {
				width: 2px;
				height: 50px;
				background: #fff;
			}

			#blinker.selected {
				animation:
					typeblink 1.2s step-end infinite;
			}

			#blinker.typing {
				background: #000;
			}

			@keyframes typeblink {
				from, to { background: #000; }
				50% { background: #fff; }
			}

			.type {
				width: 50%;

				overflow-x: hidden;

				display: flex;
				align-items: center;
			}

			.type span {
				font-size: 35px;
			}

			.type span.is_current {
				color: var(--color-medium-blue) !important;
			}

			.type span.is_wrong {
				color: grey;
				text-decoration: line-through;
			}

			.pre.type span {
				text-align: left;
				padding-right: 8px;
			}

			.post {
				display: flex;
				justify-content: flex-end;
			}

			.post.type span {
				text-align: right;
				padding-left: 8px;
				color: grey;
			}

			.typestarter {
				position: relative;
				top: 5px;

				width: 180px;
				height: 40px;
				background: var(--color-blue);

				border-radius: 10px;
				border: 1px solid var(--color-blue);

				display: flex;
				justify-content: center;
				align-items: center;

				animation:
					bounce 1.8s ease-in-out infinite;
			}

			@keyframes bounce {
				from, to { top: 5px; }
				50% { top: 20px; }
			}

			.typestarter:after,
			.typestarter:before {
				bottom: 100%;
				border: solid transparent;
				content: " ";
				height: 0;
				width: 0;
				position: absolute;
				pointer-events: none;
			}

			.typestarter:after {
				border-color: rgba(255, 255, 255, 0);
				border-bottom-color: var(--color-blue);
				border-width: 19px;
				left: 50%;
				margin-left: -19px;
			}

			.typestarter:before {
				border-color: rgba(113, 158, 206, 0);
				border-bottom-color: var(--color-blue);
				border-width: 20px;
				left: 50%;
				margin-left: -20px;
			}

			.typestarter h2 {
				padding-left: 5px;
			}

			.typestarter div {
				display: flex;
				flex-direction: row;
				justify-content: flex-start;
				align-items: center;
			}

			.blinker {
				padding: 0 !important;
				width: 4px;
				height: 28px;
				border-right: .15em solid transparent;

				animation:
					blink-caret 0.78s step-end 4;
			}

			@keyframes blink-caret {
				from, to { border-color: transparent; }
				50% { border-right: .15em solid var(--color-bright-blue); }
			}

			#typestats {
				width: 80%;
				height: 190px;

				display: flex;
				justify-content: center;
				align-items: center;
			}

			.stat {
				width: 95px;
				height: 95px;

				margin-left: 3%;
				margin-right: 3%;

				background: white;
				border-radius: 10px;

				display: flex;
				flex-direction: column;
				align-items: center;

				margin-top: 5px;
			}

			.stat div:last-child {
				font-weight: bolder;
				font-size: 40px;
			}

			.stat.pre-start.wpm {
				animation:
					swish 1.8s ease-in-out infinite;
			}

			.stat.pre-start.cpm {
				animation-delay: 0.2s !important;
				animation:
					swish 1.8s ease-in-out infinite;
			}

			.stat.pre-start.accuracy {
				animation-delay: 0.4s !important;
				animation:
					swish 1.8s ease-in-out infinite;
			}

			@keyframes swish {
				0%, 100% {
					margin-top: 0;
				}
				50% {
					margin-top: 100px;
				}
			}
		</style>

		<div id="typestats">
			<div class="stat pre-start wpm">
				<div>words/min</div>
				<div id="wpm">0</div>
			</div>
			<div class="stat pre-start cpm">
				<div>chars/min</div>
				<div id="cpm">0</div>
			</div>
			<div class="stat pre-start accuracy">
				<div>% accuracy</div>
				<div id="accuracy">0</div>
			</div>
		</div>

		<div id="typetracker">
			<div id="timebar"></div>
			<div id="timer"></div>
			<div class="post type">
				<span class="is_current"></span>
			</div>
			<input id="inputbox"/>
			<div id="blinker"></div>
			<div class="pre type">
				<span full_word='the'>the</span>
				<span full_word='of'>of</span>
				<span full_word='in'>in</span>
				<span full_word='and'>and</span>
				<span full_word='a'>a</span>
				<span full_word='is'>is</span>
				<span full_word='to'>to</span>
				<span full_word='was'>was</span>
				<span full_word='as'>as</span>
				<span full_word='for'>for</span>
				<span full_word='by'>by</span>
				<span full_word='on'>on</span>
				<span full_word='it'>it</span>
				<span full_word='he'>he</span>
				<span full_word='with'>with</span>
				<span full_word='at'>at</span>
				<span full_word='from'>from</span>
				<span full_word='an'>an</span>
				<span full_word='his'>his</span>
				<span full_word='that'>that</span>
				<span full_word='also'>also</span>
				<span full_word='are'>are</span>
				<span full_word='which'>which</span>
				<span full_word='has'>has</span>
				<span full_word='born'>born</span>
				<span full_word='or'>or</span>
				<span full_word='its'>its</span>
				<span full_word='first'>first</span>
				<span full_word='who'>who</span>
				<span full_word='new'>new</span>
				<span full_word='this'>this</span>
				<span full_word='one'>one</span>
				<span full_word='were'>were</span>
				<span full_word='american'>american</span>
				<span full_word='be'>be</span>
				<span full_word='known'>known</span>
				<span full_word='district'>district</span>
				<span full_word='national'>national</span>
				<span full_word='united'>united</span>
				<span full_word='she'>she</span>
				<span full_word='after'>after</span>
				<span full_word='county'>county</span>
				<span full_word='their'>their</span>
				<span full_word='film'>film</span>
				<span full_word='two'>two</span>
				<span full_word='been'>been</span>
				<span full_word='world'>world</span>
				<span full_word='state'>state</span>
				<span full_word='states'>states</span>
				<span full_word='had'>had</span>
				<span full_word='school'>school</span>
				<span full_word='but'>but</span>
				<span full_word='university'>university</span>
				<span full_word='south'>south</span>
				<span full_word='football'>football</span>
				<span full_word='have'>have</span>
				<span full_word='during'>during</span>
				<span full_word='album'>album</span>
				<span full_word='city'>city</span>
				<span full_word='located'>located</span>
				<span full_word='may'>may</span>
				<span full_word='they'>they</span>
				<span full_word='other'>other</span>
				<span full_word='season'>season</span>
				<span full_word='her'>her</span>
				<span full_word='not'>not</span>
				<span full_word='de'>de</span>
				<span full_word='family'>family</span>
				<span full_word='team'>team</span>
				<span full_word='part'>part</span>
				<span full_word='played'>played</span>
				<span full_word='north'>north</span>
				<span full_word='between'>between</span>
				<span full_word='most'>most</span>
				<span full_word='village'>village</span>
				<span full_word='league'>league</span>
				<span full_word='series'>series</span>
				<span full_word='released'>released</span>
				<span full_word='name'>name</span>
				<span full_word='all'>all</span>
				<span full_word='into'>into</span>
				<span full_word='when'>when</span>
				<span full_word='species'>species</span>
				<span full_word='time'>time</span>
				<span full_word='station'>station</span>
				<span full_word='member'>member</span>
				<span full_word='years'>years</span>
				<span full_word='used'>used</span>
				<span full_word='area'>area</span>
				<span full_word='only'>only</span>
				<span full_word='former'>former</span>
				<span full_word='second'>second</span>
				<span full_word='where'>where</span>
				<span full_word='over'>over</span>
				<span full_word='won'>won</span>
				<span full_word='list'>list</span>
				<span full_word='three'>three</span>
				<span full_word='music'>music</span>
				<span full_word='west'>west</span>
				<span full_word='river'>river</span>
			</div>
		</div>

		<div class="typestarter">
			<div>
				<div>
					<h2 id="typeinfo"></h2><h2 class="blinker"></h2>
				</div>
			</div>
		</div>

		<script>
			let spaninfo = "Type to start";

			function type(curr_string, curr_index, element) {
				if (typeof curr_string != "string" && curr_index >= curr_string.length)
					return;

				$(element).append(curr_string[curr_index]);

				setTimeout(type, 100, curr_string, curr_index + 1, element);
			}

			type(spaninfo, 0, $("#typeinfo"));

			$(window).on("resize", function() {
				$(".stat").css("height", $(".stat").innerWidth());
			});

			$("#timebar").css("width", "100%");
			$(".type span").on("click", blinkerselect);

			let current_timebar_radius = 25;
			let current_timebar_height = 7;
			let timer = 0;

			function changetimebar() {
				$("#timebar").css("width", ((60 - timer) / 60) * 100 + "%");

				current_timebar_radius -= current_timebar_radius < 0 ? 0 : 3;

				$("#timebar").css("border-top-right-radius", current_timebar_radius + "px");

				if (timer >= 59.7)
					current_timebar_height -= 2.4;
				$("#timebar").css("height", current_timebar_height + "px");
				$("#timebar").css("top", (7 - current_timebar_height) + "px");

				timer += 0.1;

				let calc_seconds = 60 - Math.round(timer);

				$("#timer").html((calc_seconds < 10 ? "0" : "") + calc_seconds + " second" + (calc_seconds == 1 ? "" : "s"));

				if (timer < 60)
					setTimeout(changetimebar, 100);
				else {
					$("#timerbar").animate({
						width: "100%",
					}, 1000, function() {
						$("#timerbar").css("border-top-right-radius", "25px");
					});
				}
			}

			function blinkerselect() {
				$("#inputbox").select();
				$("#blinker").addClass("selected");
			}

			blinkerselect();

			$("#inputbox").focusout(function() {
				$("#blinker").removeClass("selected");
			});

			function turnon() {
				$("#blinker").removeClass("typing");
				$("#blinker").addClass("selected");
			}

			let correct_word_count = 0;
			let bad_word_count = 0;
			let char_count = 0;

			let current_word_length = 0;
			let stall_out = 0;

			$("#inputbox").keyup(function() {
				$(".stat").removeClass("pre-start");
				$(".typestarter").hide();

				if (timer == 0)
					changetimebar(); // start timer

				if (stall_out) {
					stall_out--;
					return;
				}

				// remove typing animation
				$("#blinker").addClass("typing");
				$("#blinker").removeClass("selected");
				setTimeout(turnon, 100);

				let current_post_element = $(".post.type span:last-child");
				let current_pre_element = $(".pre.type span:first-child");

				let current_post_value = $(current_post_element).html();
				let current_post_value_length = current_post_value.length;
				let current_pre_value = $(current_pre_element).html();
				let current_pre_value_length = current_pre_value.length;

				let full_pre_word = $(current_pre_element).attr("full_word");

				let current_char = $(this).val();
				$(this).val("");

				if (current_char.length == 0) { // possible deletion
					// if current_word_length is 0, ignore this
					if (current_word_length == 0)
						return;

					if (current_post_value[current_post_value_length - 1] == full_pre_word[current_post_value_length - 1]) {
						// pass value over

						$(current_pre_element).html(current_post_value[current_post_value_length - 1] + current_pre_value);
					}

					current_post_value = current_post_value.slice(0, current_post_value_length - 1);
					current_post_value_length--;

					// check is_wrong
					if (current_post_value == full_pre_word.slice(0, current_post_value_length))
						$(current_post_element).removeClass("is_wrong");

					// update post element
					$(current_post_element).html(current_post_value);

					current_word_length--;

					return;
				}

				stall_out = current_char.length - 1;

				// loop over incoming chars
				for (let loop_char = 0; loop_char < current_char.length; loop_char++) {

					if (current_char[loop_char] == "\n")
						continue;

					if (current_char[loop_char] == " ") {
						// check if there is any characters current
						if (current_word_length) {
							$(current_pre_element).html(current_pre_value);
							$(current_post_element).html(current_post_value);

							let is_wrong_check = current_post_value == full_pre_word ? 0 : 1;

							current_post_value = "";
							current_post_value_length = 0;

							if (!is_wrong_check) {
								correct_word_count++;
								char_count += current_word_length;

								$("#wpm").html(correct_word_count);
								$("#cpm").html(char_count);
							}

							$(current_post_element).removeClass("is_current");
							if (is_wrong_check) {
								bad_word_count++;
								$(current_post_element).addClass("is_wrong");
							}
							$(".post.type").append("<span class='is_current'></span>");

							current_post_element = $(".post.type span:last-child");

							$("#accuracy").html(Math.round(correct_word_count / (correct_word_count + bad_word_count) * 100));

							$(current_post_element).on("click", blinkerselect);
							$(current_pre_element).remove();

							// update pre element if there are more characters
							if (loop_char < current_char.length - 1) {
								current_pre_element = $(".pre.type span:first-child");

								current_pre_value = $(current_pre_element).html();
							}
						}

						current_word_length = 0;
					} else {
						// if the current_char is different than current_pre_value
						// something is wrong
						if (current_char[loop_char] == current_pre_value[0])
							current_pre_value = current_pre_value.slice(1);
						else
							$(current_post_element).addClass("is_wrong");

						current_post_value += current_char[loop_char];

						current_word_length++;
					}
				}

				$(current_pre_element).html(current_pre_value);
				$(current_post_element).html(current_post_value);
			});
		</script>
	</body>
</html>